{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Homework 3 (Math 150)\n",
    "1. Determine for what constant $c$ and $\\alpha$ the function \n",
    "<br/>\n",
    "$$f(x,t)=\\frac{e^{-(x-\\alpha t)^{2}/cDt}}{\\sqrt{c\\pi Dt}}$$\n",
    "<br/> \n",
    "is a solution to the advection-diffusion equation $f_{t}=Af_{xx}-Bf_{x}$ (A and B to be defined).\n",
    "<br/>\n",
    "<br/>\n",
    "In order to find the values $c$ and $\\alpha$ we have to start by taking a partial derivative of $f$ with respect to $t$ and a first and second partial derivatice of $f$ with respect to $x$. \n",
    "\n",
    "$$f_{x}=\\frac{-2(x-\\alpha t) \\ e^{\\frac{-(x-\\alpha t)^{2}}{cDt}}}{\\sqrt{c\\pi Dt} \\ cDT}$$\n",
    "\n",
    "<br/>\n",
    "$$f_{xx} = \\frac{1}{\\sqrt{c\\pi Dt} } \\left[\\frac{-2(x-\\alpha t)}{cDt}* \\frac{-2(x-\\alpha t)}{cDt} e^{- \\frac{(x-\\alpha t)^{2}}{cDt} } + e^{-\\frac{(x-\\alpha t)^{2}}{cDt} } * \\frac{-2x}{cDt}\\right]$$\n",
    "<br/>\n",
    "\n",
    "$$ f_{t} = \\frac{ \\sqrt{c \\pi Dt} \\frac{-cDt 2(x-\\alpha t)+(x-\\alpha t)^{2} cD e^{\\frac{-(x-\\alpha t)^{2}}{cDt}}}{(cDt)^{2}} - e^{ \\frac{-(x- \\alpha t)^{2}}{cDt }} \\frac{1}{ 2\\sqrt{c\\pi Dt}}} {c \\pi Dt} $$\n",
    "<br/> \n",
    "Now that we have our partial derivatives we're going to plug them back into our original equation, $f_{t}=Af_{xx}-Bf_{x}$, and try to simplify:\n",
    "\n",
    "$$ \\frac{ \\sqrt{c \\pi Dt} \\frac{-cDt 2(x-\\alpha t)+(x-\\alpha t)^{2} cD e^{\\frac{-(x-\\alpha t)^{2}}{cDt}}}{(cDt)^{2}} - e^{ \\frac{-(x- \\alpha t)^{2}}{cDt }} \\frac{1}{ 2\\sqrt{c\\pi Dt}}} {c \\pi Dt} = $$\n",
    "\n",
    "$$ A \\frac{1}{\\sqrt{c\\pi Dt} } \\left[\\frac{-2(x-\\alpha t)}{cDt}* \\frac{-2(x-\\alpha t)}{cDt} e^{- \\frac{(x-\\alpha t)^{2}}{cDt} } + e^{-\\frac{(x-\\alpha t)^{2}}{cDt} } * \\frac{-2x}{cDt}\\right] -B\\frac{-2(x-\\alpha t) \\ e^{\\frac{-(x-\\alpha t)^{2}}{cDt}}}{\\sqrt{c\\pi Dt} \\ cDT} $$\n",
    "\n",
    "\n",
    "$$\\frac{-e^{-(x-\\alpha t)^{2}/cDt}}{2\\sqrt{\\pi}c^{\\frac{3}{2}}D^{\\frac{3}{2}}t^{\\frac{5}{2}}}=A(\\frac{-2cDt+4(x-\\alpha t)^{2}}{(cDt)^{2}\\sqrt{c\\pi Dt} \\ e^{-(x-\\alpha t)^{2}/cDt}})-B(\\frac{-2(x-\\alpha t)}{\\sqrt{2\\pi Dt}cDt} \\ e^{\\frac{-(x-\\alpha t)^{2}}{cDt }})$$\n",
    "\n",
    "\n",
    "$$\\frac{-cDt-2(\\alpha ^{2}t^{2}-x^{2})}{2\\sqrt{\\pi}c^{\\frac{3}{2}}D^{\\frac{3}{2}}t^{\\frac{5}{2}}}=A(\\frac{-2cDt+4(x-\\alpha t)^{2}}{(cDt)^{2}\\sqrt{c\\pi Dt} })-B(\\frac{-2(x-\\alpha t)}{\\sqrt{2\\pi Dt}cDt})$$\n",
    "\n",
    "$$\\frac{-cDt-2(\\alpha ^{2}t^{2}-x^{2})}{2cDt^{2}}=A(\\frac{-2cDt+4(x-\\alpha t)^{2}}{(cDt)^{2} })-B(\\frac{-2(x-\\alpha t)}{cDt})$$\n",
    "\n",
    "$$-\\frac{1}{2} (cDt+2(\\alpha ^{2}t^{2}-x^{2})=A(-2cDt+4(x-\\alpha t)^{2}) - B(-2(x-\\alpha t)(cDt))$$\n",
    "\n",
    "$$ cDt+2(\\alpha ^{2}t^{2}-x^{2}) = A(4cDt-8(x-\\alpha t)^{2})-4B(x-\\alpha t)(cDt) $$\n",
    "$$2(\\alpha ^{2}t^{2}-x^{2})=3cDt-8(x-\\alpha t)^{2} -4(x-\\alpha t)(cDt)  $$\n",
    "\n",
    "After this point I was too lazy to continue this simplification marathon and I got a bit confused with all the arithmetic so I ended up using Wolfram Alpha to simplify. I conclude that $f(x,t)$ is a solution to the advection-diffusion equation for $c=-\\frac{4A}{D}$ and $\\alpha=B$. \n",
    "\n",
    "\n",
    "2. Show that $\\int_{-\\infty}^{\\infty} \\frac{e^{\\frac{-x^{2}}{L}}}{\\sqrt{\\pi L}}dx=1$. What do you deduce for $f$?\n",
    "<br/>\n",
    "<br/>\n",
    "Since the problem above involves an improper integral, we'll first need to split up the integral (and take two limits), then apply integration by parts. Its also important to notice the form of our integral is very similar to the form of the error function. Due to its similarity to the error function, we can apply what we know about integrating the error function as follows:\n",
    "<br/>\n",
    "$$\\int_{-\\infty}^{\\infty} \\frac{e^{\\frac{-x^{2}}{L}}}{\\sqrt{\\pi L}}dx= \\frac{1}{\\sqrt{\\pi L}}\\int_{-\\infty}^{\\infty} e^{\\frac{-x^{2}}{L}}dx =$$ \n",
    "\n",
    "$$ \\frac{1}{\\sqrt{\\pi L}} \\left[\\frac{2}{\\sqrt{\\pi}} \\lim_{t\\rightarrow \\infty}\\int_{0}^{t} e^{\\frac{-x^{2}}{L}} dx + \\frac{2}{\\sqrt{\\pi}} \\lim_{t\\rightarrow -\\infty}\\int_{0}^{t} e^{\\frac{-x^{2}}{L}dx} \\right] $$\n",
    "\n",
    "$$\\frac{1}{\\sqrt{\\pi L}} \\left[ \\frac{\\sqrt{\\pi L}}{2} +  \\frac{\\sqrt{\\pi L}}{2}   \\right] = \\frac{1}{\\sqrt{\\pi L}} \\sqrt{\\pi L}=1$$\n",
    "<br/>\n",
    "I deduce that f is very similar to the Gaussian Probability Function (GPF) since we get results that are directly correlated to the solution of the GPF.\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "3. Derive the governing equation, and its parameter, describing the expectation of the number of walkers moving in a two dimensional plane, at location $(x,y)$ at time $t$ if every time step $\\Delta t$ the walkers follow the following rule:\n",
    "<br/>\n",
    "-Take a step left of length $\\Delta x$ with probability 1/6\n",
    "<br/>\n",
    "-Take a step right of length $\\Delta x$ with probability 1/6\n",
    "<br/>\n",
    "-Take a step down of length $\\Delta y$ with probability 1/3\n",
    "<br/>\n",
    "-Take a step up of length $\\Delta y$ with probability 1/3\n",
    "<br/>\n",
    "\n",
    "\n",
    "Here we track the expectation of the walkers using the rules above meaning: \n",
    "<br/>\n",
    "<br/>\n",
    "$$\\left[P_{left}=\\frac{1}{6}, P_{right}=\\frac{1}{6}, P_{down}=\\frac{1}{3},  P_{up}=\\frac{1}{3}        \\right]$$\n",
    "<br/>\n",
    "Represents the respective probabilities of moving left, right, down and up. The corresponding equation modeling the expectation of the walkers in four directions is thus:\n",
    "$$C(x,y,t+\\Delta t)=\\frac{1}{6}C(x-\\Delta x,y,t) + \\frac{1}{6}C(x+\\Delta x,y,t) +\\frac{1}{3}C(x,y-\\Delta y,t)+\\frac{1}{3}C(x,y+\\Delta y,t)$$\n",
    "\n",
    "In order to derive the governing equation to describe the system of walkers we now take the difference between two time steps to find the rate of change in the x and y direction with respect to the time step $\\Delta t$, as follows:\n",
    "\n",
    "$$C(x,y,t+\\Delta t)-2C(x,y,t)= \\frac{1}{6} \\left[C(x+\\Delta x,y,t) -6C(x,y,t)+C(x-\\Delta x,y,t)\\right] + \\frac{1}{3} \\left[C(x,y+\\Delta y,t) -3C(x,y,t)+C(x,y-\\Delta y,t)\\right]$$\n",
    "\n",
    "Now if we look at the form of the left hand side (LHS) and the right hand side (RHS) of the equation we can see the LHS is approximately equal to,\n",
    "\n",
    "$$\\sim \\Delta t\\frac{\\partial C(x,y,t)}{\\partial t} $$ while the first term on the RHS (with respect to change in the x-direction) is approximately equal to,\n",
    "\n",
    "$$\\sim \\frac{1}{6} \\Delta x^{2}\\frac{\\partial^2 C(x,y,t)}{\\partial x^{2}}$$ and the second term on the RHS (with respect to change in the y-direction) is approximately equal to,\n",
    "\n",
    "$$\\sim \\frac{1}{3} \\Delta y^{2}\\frac{\\partial^2 C(x,y,t)}{\\partial y^{2}}$$\n",
    "\n",
    "Putting it all together and dividing both sides by $\\Delta t$ gives the following result:\n",
    "<br/>\n",
    "<br/>\n",
    "$$ \\frac{\\partial C(x,y,t)}{\\partial t} = \\frac{1}{6} \\frac {\\Delta x^{2}}{\\Delta t} \\frac{\\partial^2 C(x,y,t)}{\\partial x^{2}} + \\frac{1}{3} \\frac{\\Delta y^{2}}{\\Delta t} \\frac{\\partial^2 C(x,y,t)}{\\partial y^{2}}$$\n",
    "\n",
    "Finally, since we want to keep $\\frac{\\Delta x^{2}}{\\Delta t}$ and $\\frac{\\Delta y^{2}}{\\Delta t}$ constant so we will denote them as  $U$ and $V$, respectively. This gives us the final equation that models the system of walkers.\n",
    "\n",
    "$$\\frac{\\partial C}{\\partial t} = \\frac{U}{6} \\frac{\\partial^2 C}{\\partial x^{2}} + \\frac{V}{3} \\frac{\\partial^2 C}{\\partial y^{2}}$$"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
